
---

# Isochrone_UI

Isochrone_UI是一个用于城市分析的工具，支持生成等时圈（Isochrones）并输出多种格式的结果,这个版本实现了可视化和UI操作。以下是本工具的主要功能和使用说明。

## 主要功能

### 1. 实现完整的等时圈生成逻辑
- **添加了 generate_isochrone 方法**：包含完整的4步等时圈生成流程：
  1. 下载路网数据
  2. 构建和投影步行网络
  3. 计算等时圈范围
  4. 生成可视化地图输出

### 2. 特色功能增强
- **动态步行距离**：使用界面上的距离设置（500米到5000米可调，默认1000米）
- **中文名称处理**：使用 `pypinyin` 自动转换中文站点名为拼音
- **多格式输出**：同时输出 PNG 地图和 Shapefile 矢量文件
- **进度反馈**：详细的进度更新显示在界面上

### 3. 进度报告优化
- **基于点位数量计算总体进度百分比**
- **每个处理步骤都有清晰的进度反馈**
- **处理多个点位时逐个报告进度**

### 4. 错误处理
- **增强的异常捕获和处理**
- **单点错误不会导致整个批处理失败**
- **详细的错误信息显示**

## 使用说明

### 选择输入文件
- 支持 CSV、TXT 和 Excel 格式的输入文件。

### 设置输出目录
- 选择生成结果的输出目录。

### 调整步行距离
- 默认步行距离为1000米，可在500米到5000米之间调整。

### 开始处理
- 点击 "Generate Isochrones" 按钮开始处理，并查看进度反馈。

### 查看结果
- 处理完成后，在输出目录中查看结果。程序会为每个坐标点生成两个结果文件：
  - **PNG格式地图**：包含底图、路网和等时圈轮廓。
  - **Shapefile格式矢量文件**：可在GIS软件中进一步编辑。

# 注意！ 地图选点功能暂时无法自动输入坐标，后续版本会修正

## 交互和UI改进

### 取消选点方式
- **取消按钮**：在选点模式激活时显示。
- **ESC键**：按下ESC键取消选点模式。
- **右键点击地图**：右键点击地图取消选点模式。
- **状态提示更新**：告知用户可以使用ESC或右键取消选点模式。

### 确认按钮
- **新增确认按钮**：在地图下方状态栏添加绿色 "Confirm Point" 按钮。
- **改进选点流程**：
  - 点击地图后启用确认按钮，保存临时选择的坐标。
  - 只有点击确认按钮后才会打开编辑对话框。

### 临时标记和状态栏信息
- **可拖动的临时标记**：点击地图添加可拖动的蓝色标记。
- **坐标信息弹出窗口**：显示当前选择的坐标和调整位置的提示。
- **状态栏信息更新**：显示当前选择的精确坐标，提示用户可以点击 "Confirm Point" 按钮或按 Enter 键确认。

## 使用流程

1. 点击 "Add Point From Map" 按钮进入选点模式。
2. 阅读弹出的操作说明。
3. 点击地图添加临时标记（蓝色，可拖动）。
4. 需要时拖动标记精确调整位置。
5. 确定位置后，通过以下方式之一确认：
   - 点击界面下方的 "Confirm Point" 按钮
   - 按键盘上的 Enter 键
6. 确认后会弹出命名对话框。

这个新设计既保留了操作的简便性，又提高了精确度和可用性，使您能够更加轻松地选择和确认坐标点。

---
